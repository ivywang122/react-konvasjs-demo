(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{100:function(e,n,t){},101:function(e,n,t){"use strict";t.r(n);var o=t(0),a=t.n(o),r=t(24),i=t.n(r),c=t(9),l=t(19),s=t(13),u=t(14),d=t(16),f=t(15),p=t(17),m=t(4),g=t(10),h=t(23),b=t.n(h),v=t(11),x=t(18),k=t.n(x),w=function(e){function n(e){var t;return Object(s.a)(this,n),(t=Object(d.a)(this,Object(f.a)(n).call(this,e))).state={posX:t.props.posX,posY:t.props.posY,color:t.props.color},t}return Object(p.a)(n,e),Object(u.a)(n,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"componentDidUpdate",value:function(e,n){}},{key:"shouldComponentUpdate",value:function(e,n){return this.state!==n}},{key:"render",value:function(){var e=this.state,n=e.posX,t=e.posY,o=e.color;return a.a.createElement(v.Circle,{x:n,y:t,radius:5,fill:o})}}]),n}(o.Component),C=t(8),S=t(40),y=t.n(S),E=t(41),j=t.n(E),O=t(42),I=t.n(O),_=t(43),M=t.n(_);function T(){var e=Object(c.a)(["\n  background-color: gray;\n  flex: 50%;\n  padding-bottom: 50%;\n  box-shadow: 0 0 0 5px #fff;\n  background-image: ",";\n  background-size: cover;\n  background-position: 50% 50%;\n"]);return T=function(){return e},e}function R(){var e=Object(c.a)(["\n  width: 300px;\n  height: 300px;\n  padding: 30px;\n  position: relative;\n  background-color: #fff;\n  border-radius: 3px;\n  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.5);\n  .fa-icon {\n    position: absolute;\n    right: 10px;\n    top: 10px;\n    cursor: pointer;\n  }\n  .options-container {\n    width: 100%;\n    height: 100%;\n    .options-row-wrapper {\n      display: flex;\n    }\n  }\n"]);return R=function(){return e},e}function U(){var e=Object(c.a)(["\n  position: fixed;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 2;\n  width: 100%;\n  height: 100vh;\n  background-color: rgba(0, 0, 0, 0.7);\n"]);return U=function(){return e},e}var B=function(e){function n(e){var t;return Object(s.a)(this,n),(t=Object(d.a)(this,Object(f.a)(n).call(this,e))).state={},t}return Object(p.a)(n,e),Object(u.a)(n,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"componentDidUpdate",value:function(e,n){}},{key:"shouldComponentUpdate",value:function(e,n){return this.state!==n}},{key:"render",value:function(){var e=this,n=y.a,t=j.a,o=I.a,r=M.a;return a.a.createElement(D,null,a.a.createElement(N,null,a.a.createElement(C.j,{className:"fa-icon",onClick:this.props.onCloseImgBox}),a.a.createElement("div",{className:"options-container"},a.a.createElement("div",{className:"options-row-wrapper"},a.a.createElement(X,{onClick:function(){return e.props.onImgSelect(n)},imgurl:n}),a.a.createElement(X,{onClick:function(){return e.props.onImgSelect(t)},imgurl:t})),a.a.createElement("div",{className:"options-row-wrapper"},a.a.createElement(X,{onClick:function(){return e.props.onImgSelect(o)},imgurl:o}),a.a.createElement(X,{onClick:function(){return e.props.onImgSelect(r)},imgurl:r})))))}}]),n}(o.Component),D=g.a.div(U()),N=g.a.div(R()),X=g.a.div(T(),function(e){return e.imgurl?"url("+e.imgurl+")":null}),Y=B;function A(){var e=Object(c.a)(["\n  width: 20px;\n  height: 20px;\n  background-color: ",";\n  border: 1px solid gray;\n"]);return A=function(){return e},e}function z(){var e=Object(c.a)(["\n  width: 18px;\n  height: 18px;\n  border: 3px solid #fefefe;\n  box-shadow: 0 0 0 1px ",";\n  margin-right: 8px;\n  border-radius: 50%;\n  background-color: ",";\n"]);return z=function(){return e},e}function W(){var e=Object(c.a)(["\n  display: flex;\n  align-items: center;\n  margin-left: 5px;\n"]);return W=function(){return e},e}function F(){var e=Object(c.a)(["\n  padding: 5px;\n  font-size: 16px;\n  line-height: 20px;\n  color: ",";\n  position: absolute;\n  z-index: 10;\n  background-color: transparent;\n  left: ",";\n  top: ",";\n  border: 1px solid #007fff;\n  border-radius: 3px;\n  resize: none;\n"]);return F=function(){return e},e}function L(){var e=Object(c.a)(["\n  width: 100%;\n  height: 40px;\n  font-size: 18px;\n  color: #1a1a1a;\n  background-color: #efefef;\n  border-bottom: 1px solid #e0e0e0;\n  display: flex;\n  justify-content: space-between;\n  .left,\n  .right {\n    display: flex;\n  }\n  .icon-wrapper {\n    text-align: center;\n    line-height: 40px;\n    height: 40px;\n    width: 40px;\n    cursor: pointer;\n    &.active,\n    &:hover {\n      background-color: #ddd;\n    }\n  }\n"]);return L=function(){return e},e}function J(){var e=Object(c.a)(["\n  width: 100%;\n  height: 100vh;\n  background-color: goldenrod;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  .frame {\n    background-color: #fff;\n    box-shadow: 0 12px 40px 0 rgba(0, 0, 0, 0.5);\n  }\n"]);return J=function(){return e},e}var P="#E83015",K="#005CAF",$="#FFC408",q="#F05E1C",G="#1B813E",H="#6F3381",Q="#ffffff",V="#707C74",Z="#000000",ee=function(e){function n(e){var t;return Object(s.a)(this,n),(t=Object(d.a)(this,Object(f.a)(n).call(this,e))).onMouseDown=t._onMouseDown.bind(Object(m.a)(Object(m.a)(t))),t.onMouseMove=t._onMouseMove.bind(Object(m.a)(Object(m.a)(t))),t.onMouseUp=t._onMouseUp.bind(Object(m.a)(Object(m.a)(t))),t.onToolChange=t._onToolChange.bind(Object(m.a)(Object(m.a)(t))),t.onImgSelect=t._onImgSelect.bind(Object(m.a)(Object(m.a)(t))),t.onStageClick=t._onStageClick.bind(Object(m.a)(Object(m.a)(t))),t.onTextChange=t._onTextChange.bind(Object(m.a)(Object(m.a)(t))),t.onTextEnter=t._onTextEnter.bind(Object(m.a)(Object(m.a)(t))),t.onColorSelect=t._onColorSelect.bind(Object(m.a)(Object(m.a)(t))),t.onUndo=t._onUndo.bind(Object(m.a)(Object(m.a)(t))),t.onRedo=t._onRedo.bind(Object(m.a)(Object(m.a)(t))),t.onShowImgBox=t._onShowImgBox.bind(Object(m.a)(Object(m.a)(t))),t.onCloseImgBox=t._onCloseImgBox.bind(Object(m.a)(Object(m.a)(t))),t.onDownload=t._onDownload.bind(Object(m.a)(Object(m.a)(t))),t.onAllClear=t._onAllClear.bind(Object(m.a)(Object(m.a)(t))),t.downloadURI=t._downloadURI.bind(Object(m.a)(Object(m.a)(t))),t.state={lines:[],lineColors:[],eraseImgs:[],dots:[],texts:[],text:"",tX:0,tY:0,color:"red",isDrawing:!1,isErasing:!1,toolState:0,isShowText:!1,isShowImgSelectBox:!1,historyStep:0,history:[],imgurl:"",isBgImg:!1,imgId:void 0},t}return Object(p.a)(n,e),Object(u.a)(n,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e=this,n=this.state,t=n.toolState,o=n.dots,r=n.lines,i=n.lineColors,c=n.eraseImgs,l=n.texts,s=n.isShowImgSelectBox,u=n.isShowText,d=n.tX,f=n.tY,p=n.color;return a.a.createElement("div",{className:"App"},s?a.a.createElement(Y,{onImgSelect:this.onImgSelect,onCloseImgBox:this.onCloseImgBox}):null,a.a.createElement(ne,null,a.a.createElement("div",{className:"frame"},a.a.createElement(te,null,a.a.createElement("div",{className:"left"},a.a.createElement("div",{className:k()("icon-wrapper",{active:0===t}),onClick:function(){return e.onToolChange(0)}},a.a.createElement(C.c,null)),a.a.createElement("div",{className:k()("icon-wrapper",{active:1===t}),onClick:function(){return e.onToolChange(1)}},a.a.createElement(C.d,null)),a.a.createElement("div",{className:k()("icon-wrapper",{active:2===t}),onClick:function(){return e.onToolChange(2)}},a.a.createElement(C.b,null)),a.a.createElement("div",{className:"icon-wrapper",onClick:this.onShowImgBox},a.a.createElement(C.f,null)),a.a.createElement("div",{className:k()("icon-wrapper",{active:3===t}),onClick:function(){return e.onToolChange(3)}},a.a.createElement(C.e,null)),3===t?a.a.createElement(ae,null,a.a.createElement(re,{color:P,isSelected:"red"===p,onClick:function(){return e.onColorSelect("red")}}),a.a.createElement(re,{color:q,isSelected:"orange"===p,onClick:function(){return e.onColorSelect("orange")}}),a.a.createElement(re,{color:$,isSelected:"yellow"===p,onClick:function(){return e.onColorSelect("yellow")}}),a.a.createElement(re,{color:G,isSelected:"green"===p,onClick:function(){return e.onColorSelect("green")}}),a.a.createElement(re,{color:K,isSelected:"blue"===p,onClick:function(){return e.onColorSelect("blue")}}),a.a.createElement(re,{color:H,isSelected:"purple"===p,onClick:function(){return e.onColorSelect("purple")}}),a.a.createElement(re,{color:V,isSelected:"gray"===p,onClick:function(){return e.onColorSelect("gray")}}),a.a.createElement(re,{color:Q,isSelected:"white"===p,onClick:function(){return e.onColorSelect("white")}}),a.a.createElement(re,{color:Z,isSelected:"black"===p,onClick:function(){return e.onColorSelect("black")}})):a.a.createElement(ae,null,a.a.createElement(ie,{color:p}))),a.a.createElement("div",{className:"right"},a.a.createElement("div",{className:"icon-wrapper",onClick:this.onAllClear},a.a.createElement(C.k,null)),a.a.createElement("div",{className:k()("icon-wrapper",{active:4===t}),onClick:function(){return e.onToolChange(4)}},a.a.createElement(C.a,null)),a.a.createElement("div",{className:"icon-wrapper",onClick:this.onRedo},a.a.createElement(C.i,null)),a.a.createElement("div",{className:"icon-wrapper",onClick:this.onUndo},a.a.createElement(C.g,null)),a.a.createElement("div",{className:"icon-wrapper",onClick:this.onDownload},a.a.createElement(C.h,null)))),a.a.createElement("div",{style:{position:"relative"}},2===t&&u?a.a.createElement(oe,{ref:function(n){return e.textRef=n},left:d,top:f,color:p,onChange:this.onTextChange,onKeyPress:this.onTextEnter}):null,a.a.createElement(v.Stage,{ref:function(n){return e.stageRef=n},width:800,height:600,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onMouseMove:this.onMouseMove,onTouchStart:this.onMouseDown,onTouchEnd:this.onMouseUp,onTouchMove:this.onMouseMove,onClick:this.onStageClick},a.a.createElement(v.Layer,{ref:function(n){return e.layerRef=n}},o.length>0?o.map(function(e,n){return a.a.createElement(w,{key:"dot-"+n,posX:e.posX,posY:e.posY,color:p})}):null,r.length>0?r.map(function(e,n){return a.a.createElement(v.Line,{key:"line"+n,lineJoin:"round",lineCap:"round",strokeWidth:5,points:e,stroke:i[n]})}):null,l.length>0?l.map(function(e,n){return a.a.createElement(v.Text,{key:"text-"+n,x:e.posX,y:e.posY,text:e.text,fill:e.color,fontSize:16})}):null,c.length>0?c.map(function(n,t){return a.a.createElement(v.Image,{key:"img"+t,ref:function(n){return e.imageRef=n},x:n.x,y:n.y,width:10,height:10,stroke:"blue",fill:"red",globalCompositeOperation:"destination-out"})}):null))))))}},{key:"_onMouseDown",value:function(){var e=this.state,n=e.toolState,t=e.lines,o=e.lineColors,a=e.color;1===n?this.setState({isDrawing:!0,lines:[].concat(Object(l.a)(t),[[]]),lineColors:[].concat(Object(l.a)(o),[a])}):4===n&&this.setState({isErasing:!0})}},{key:"_onMouseMove",value:function(e){var n=this.state,t=n.toolState,o=n.isDrawing,a=n.isErasing,r=n.lines,i=n.eraseImgs,c=(n.color,this.stageRef.getStage().getPointerPosition());if(1===t){if(!o)return;var s=r[r.length-1];s=s.concat([c.x,c.y]),r.splice(r.length-1,1,s),this.setState({lines:r})}else if(4===t){if(!a)return;var u={x:c.x,y:c.y};i=[].concat(Object(l.a)(i),[u]),this.setState({eraseImgs:i})}}},{key:"_onMouseUp",value:function(){this.setState({isDrawing:!1,isErasing:!1})}},{key:"_onToolChange",value:function(e){this.setState({toolState:e})}},{key:"_onImgSelect",value:function(e){if(this.layerRef.getChildren()[0])for(var n=this.layerRef.getChildren(function(e){return"Image"===e.getClassName()}),t=0;t<n.length;t++)if(n[t]._id===this.state.imgId){n[t].destroy(),this.layerRef.draw();break}this.layerRef.getCanvas()._canvas.setAttribute("style","background: url("+e+")"),this.setState({imgurl:e,isShowImgSelectBox:!1,isBgImg:!0})}},{key:"_onStageClick",value:function(e){var n=this,t=this.state,o=t.toolState,a=t.dots,r={},i=e.evt.offsetX,c=e.evt.offsetY;0===o?(r={posX:i,posY:c},a=[].concat(Object(l.a)(a),[r])):2===o&&this.setState({isShowText:!0,tX:i,tY:c},function(){return n.textRef.focus()}),this.setState({dots:a})}},{key:"_onTextChange",value:function(e){this.setState({text:e.target.value})}},{key:"_onTextEnter",value:function(e){if("Enter"===e.key){var n=this.state,t=n.texts,o=n.tX,a=n.tY,r=n.text,i=n.color;t=[].concat(Object(l.a)(t),[{text:r,posX:o+6,posY:a+9,color:i}]),this.setState({texts:t,isShowText:!1,tX:0,tY:0})}}},{key:"_onColorSelect",value:function(e){this.setState({color:e})}},{key:"_onUndo",value:function(){}},{key:"_onRedo",value:function(){}},{key:"_onAllClear",value:function(){this.setState({dots:[],lines:[],eraseImgs:[],texts:[]})}},{key:"_onShowImgBox",value:function(){this.setState({isShowImgSelectBox:!0})}},{key:"_onCloseImgBox",value:function(){this.setState({isShowImgSelectBox:!1})}},{key:"_onDownload",value:function(){var e=this,n=this.state,t=n.imgurl;if(n.isBgImg){var o=new window.Image;o.setAttribute("crossOrigin","anonymous"),o.src=t,o.width=800,o.height=600,o.onload=function(){var n=new b.a.Image({x:0,y:0,image:o,opacity:1,globalCompositeOperation:"destination-over"});e.layerRef.add(n),e.layerRef.draw(),e.setState({imgId:n._id}),setTimeout(function(){var n=e.stageRef.toDataURL();e.downloadURI(n,"stage.png")},100)}}else setTimeout(function(){var n=e.stageRef.toDataURL();e.downloadURI(n,"stage.png")},100)}},{key:"_downloadURI",value:function(e,n){var t=document.createElement("a");t.download=n,t.href=e,document.body.appendChild(t),t.click(),document.body.removeChild(t)}}]),n}(o.Component),ne=g.a.div(J()),te=g.a.div(L()),oe=g.a.textarea(F(),function(e){return e.color?e.color:"black"},function(e){return e.left?e.left+"px":0},function(e){return e.top?e.top+"px":0}),ae=g.a.div(W()),re=g.a.div(z(),function(e){return e.isSelected?"blue":"#aaa"},function(e){return e.color?e.color:"gray"}),ie=g.a.div(A(),function(e){return e.color}),ce=ee;t(100),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(ce,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},40:function(e,n,t){e.exports=t.p+"static/media/canvas1.d6432a4c.png"},41:function(e,n,t){e.exports=t.p+"static/media/canvas2.e6af9118.png"},42:function(e,n,t){e.exports=t.p+"static/media/canvas3.2f75bb24.png"},43:function(e,n,t){e.exports=t.p+"static/media/canvas4.ac6768a6.png"},47:function(e,n,t){e.exports=t(101)}},[[47,1,2]]]);
//# sourceMappingURL=main.0f356f99.chunk.js.map